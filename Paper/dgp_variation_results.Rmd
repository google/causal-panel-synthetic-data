---
title: 'DGP Variations'
output:
  pdf_document: default
  bookdown::html_document2: default
  html_document:
    df_print: paged
  word_document: default
header-includes:
- \usepackage{caption}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(dplyr, furrr,here,tictoc, gt, ggplot2, gridExtra, knitr,
               stringr, tidyr)
source(here("r_code/factor_dgp.R"))
source(here("r_code/seed_metrics.R"))
plan(multiprocess, workers=availableCores()-1)
```


## For Loop Over DGPs

```{r dgp-loop, echo=FALSE, fig.height=9, fig.width=10}
#source(here("r_code/benchmark_factor_dgp.R"))
source(here("r_code/markdown_figure_gen.R"))

dataset_names=setdiff(list.files(here::here("Data", "Variations")), "Old")
methods_used=c("gsynth", "scdid", "scdid_uncon", "scm", "gfoo",
               "mc", "causalimpact")
for_gt=lapply(dataset_names, gt_set_up, method_vec=methods_used)

markdown_estimation_output(for_gt[[1]], dataset_names[[1]],
                           method_vec = methods_used,
                           plot_indiv = T)
markdown_estimation_output(for_gt[[2]], dataset_names[[2]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[3]], dataset_names[[3]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[4]], dataset_names[[4]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[5]], dataset_names[[5]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[6]], dataset_names[[6]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[7]], dataset_names[[7]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[8]], dataset_names[[8]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[9]], dataset_names[[9]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[10]], dataset_names[[10]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[11]], dataset_names[[11]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[12]], dataset_names[[12]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[13]], dataset_names[[13]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[14]], dataset_names[[14]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[15]], dataset_names[[15]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[16]], dataset_names[[16]], 
                           method_vec = methods_used)
markdown_estimation_output(for_gt[[17]], dataset_names[[17]], 
                           method_vec = methods_used)


#for_gt[[2]]=for_gt[[1]]
#dataset_names[[2]]=dataset_names[[1]]


# for(i in 1:2){
#   markdown_estimation_output(for_gt[[i]], dataset_names[[i]], method_vec = methods_used)
# 
# }

# furrr::future_map2(.x=for_gt, .y=dataset_names,
#                    .f=~markdown_estimation_output(tib_to_gt_data=.x,
#                                                   datalist=.y,
#                                                   method_vec = methods_used))


```


